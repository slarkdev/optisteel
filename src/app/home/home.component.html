<div class="container">
  <!-- Barra lateral fija -->
  <mat-drawer-container autosize>
    <mat-drawer
      class="ancho-sidenav"
      mode="side"
      opened
      position="start"
      [class.expanded]="isExpanded"
      [class.collapsed]="!isExpanded"
    >
      <aside class="sidebar" aria-label="Navegación">
        <div
          class="top-sidenav-logo"
          title="OPTISTEEL"
          (click)="toggleSidenav()"
        >
          <div class="top-brand" aria-label="OPTISTEEL">
            <img src="optLogo.svg" alt="OPTISTEEL Logo" class="brand-icon" />
            <span class="label-icon" *ngIf="isExpanded">OPTISTEEL</span>
          </div>
        </div>

        <button
          class="navbtn"
          title="Proyectos"
          [routerLink]="['./proyectos']"
          (click)="navigateToProyectos()"
          routerLinkActive="active"
        >
          <mat-icon class="icon">folder</mat-icon>
          <span class="label-icon" *ngIf="isExpanded">Proyectos</span>
        </button>
        <button
          class="navbtn"
          title="Datos"
          [routerLink]="['./datos']"
          routerLinkActive="active"
        >
          <mat-icon class="icon">description</mat-icon>
          <span class="label-icon" *ngIf="isExpanded">Datos</span>
        </button>
        <button
          class="navbtn"
          title="Inventario"
          [routerLink]="['./inventario']"
          routerLinkActive="active"
        >
          <mat-icon class="icon">inventory_2</mat-icon>
          <span class="label-icon" *ngIf="isExpanded">Inventario</span>
        </button>

        <button
          class="navbtn"
          title="Configuración"
          [routerLink]="['./configuracion']"
          routerLinkActive="active"
        >
          <mat-icon class="icon"
            ><span class="material-symbols-rounded">settings</span></mat-icon
          >

          <span class="label-icon" *ngIf="isExpanded">Configuración</span>
        </button>
        
        <button
          class="navbtn"
          title="Analisis"
          [routerLink]="['./analisis']"
          routerLinkActive="active"
        >
          <mat-icon class="icon">manufacturing</mat-icon>
          <span class="label-icon" *ngIf="isExpanded">Análisis</span>
        </button>

        <div class="spacer"></div>
        <button
          class="navbtn"
          title="Ayuda"
          [routerLink]="['./ayuda']"
          routerLinkActive="active"
        >
          <mat-icon class="icon">help</mat-icon>
          <span class="label-icon" *ngIf="isExpanded">Ayuda</span>
        </button>
        <button class="navbtn" title="Salir" (click)="logout()">
          <mat-icon class="icon">exit_to_app</mat-icon>
          <span class="label-icon" *ngIf="isExpanded">Cerrar Sesión</span>
        </button>
      </aside>
    </mat-drawer>

    <div class="container">
      <!-- Toolbar horizontal -->
      <div class="topbar">
        <div class="topbar-inner">
          <div class="ctx">
            <div class="pill">
              <span class="k">Proyecto</span>
              <select
                aria-label="Cambiar proyecto"
                [(ngModel)]="proyectoSeleccionado"
                (change)="buscarLotesPorProyecto()"
                [disabled]="proyectoDeshabilitado"
              >
                <option *ngFor="let proyecto of proyectos" [ngValue]="proyecto">
                  {{ proyecto.name }}
                </option>
              </select>

              <i class="material-icons spin" *ngIf="isLoadingProyecto"
                >autorenew</i
              >
            </div>

            <div class="pill">
              <span class="k">Lote</span>
              <select
                aria-label="Cambiar lote"
                [(ngModel)]="loteSeleccionado"
                (change)="buscarInventarioPorLote()"
                [disabled]="loteDeshabilitado"
              >
                <option *ngFor="let lote of lotes" [ngValue]="lote">
                  {{ lote.NombreTrabajo }}
                </option>
              </select>

              <i
                class="material-icons spin"
                *ngIf="isLoadingLote"
                style="font-size: 20px"
                >autorenew</i
              >
            </div>
          </div>

          <span class="spacer"></span>
          <span class="hint"
            >Gestiona proyectos del proyecto seleccionado.</span
          >

          <!-- <button
            *ngIf="drawerMode === 'over'"
            mat-icon-button
            (click)="drawer.toggle()"
          >
            <mat-icon>menu</mat-icon>
          </button> -->
        </div>
      </div>

      <!-- Contenido debajo del toolbar -->
      <main class="main">
        <router-outlet></router-outlet>
      </main>
    </div>
  </mat-drawer-container>
</div>
